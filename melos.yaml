name: nexus_store_workspace

packages:
  - packages/**

command:
  bootstrap:
    usePubspecOverrides: true
  version:
    updateGitTagRefs: true
    workspaceChangelog: true

scripts:
  analyze:
    run: dart analyze --fatal-infos
    exec:
      concurrency: 1
    description: Run dart analyze in all packages

  test:dart:
    run: dart test
    exec:
      concurrency: 1
    packageFilters:
      dirExists: test
      noDependsOn: flutter
    description: Run tests in Dart packages

  test:flutter:
    run: flutter test
    exec:
      concurrency: 1
    packageFilters:
      dirExists: test
      dependsOn: flutter
    description: Run tests in Flutter packages

  test:coverage:
    run: dart test --coverage=coverage
    exec:
      concurrency: 1
    packageFilters:
      dirExists: test
      noDependsOn: flutter
    description: Run tests with coverage in Dart packages

  build:runner:
    run: dart run build_runner build --delete-conflicting-outputs
    exec:
      concurrency: 1
    packageFilters:
      dependsOn: build_runner
    description: Run build_runner in packages that need it

  format:
    run: dart format .
    exec:
      concurrency: 1
    description: Format all Dart code

  format:check:
    run: dart format --set-exit-if-changed .
    exec:
      concurrency: 1
    description: Check formatting without making changes

  clean:
    run: |
      rm -rf .dart_tool
      rm -rf build
      rm -rf coverage
    exec:
      concurrency: 1
    description: Clean build artifacts
